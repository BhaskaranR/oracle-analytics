-- Survey Comments
INSERT INTO rb_survey_comments (respondent_id, comment_text) VALUES (1000, 'Consumer moment establish chance force loss above. end user Study possible yes piece. career Two understand contain they.');
INSERT INTO rb_survey_comments (respondent_id, comment_text) VALUES (1001, 'Late tell my strong. assistance No floor experience head kind step. client Four inside race statement.');
INSERT INTO rb_survey_comments (respondent_id, comment_text) VALUES (1002, 'Follow mention maintain door family mission author. from_within Newspaper role laugh short. cooperation While she official at mission.');
INSERT INTO rb_survey_comments (respondent_id, comment_text) VALUES (1003, 'Want agency one last happen time. development Anyone consumer although too character. transfer Son understand computer sort bit specific sure.');
INSERT INTO rb_survey_comments (respondent_id, comment_text) VALUES (1004, 'Subject town some top TV. customer Technology miss here front bar start. IJP Dinner miss population Mrs head.');
INSERT INTO rb_survey_comments (respondent_id, comment_text) VALUES (1005, 'Last event deep available during certain. from_within Stand near item training. onboarding Continue relationship sit career.');
INSERT INTO rb_survey_comments (respondent_id, comment_text) VALUES (1006, 'Life husband admit well represent. orientation As start like player head fish check. IJP Another long recent month foreign identify.');
INSERT INTO rb_survey_comments (respondent_id, comment_text) VALUES (1007, 'Matter often wind audience college head prepare activity. collaboration Food without think choose individual plan. promotion Continue month you wait every father stock.');
INSERT INTO rb_survey_comments (respondent_id, comment_text) VALUES (1008, 'Stay head enter individual. lateral Fire plant in should surface government bit theory. growth Black catch shake stage.');
INSERT INTO rb_survey_comments (respondent_id, comment_text) VALUES (1009, 'Do measure within western information. career Particularly song when exactly soon sign. help Lot drug candidate past suffer keep.');
INSERT INTO rb_survey_comments (respondent_id, comment_text) VALUES (1010, 'Range whose enter go teacher his. cooperation Appear cultural base husband. support Remain else democratic financial.');
INSERT INTO rb_survey_comments (respondent_id, comment_text) VALUES (1011, 'Three but rather under budget to deep. transfer Involve billion others. user Husband reason begin song whole responsibility.');
INSERT INTO rb_survey_comments (respondent_id, comment_text) VALUES (1012, 'Understand ball still alone son. onboarding Make return most. transfer Surface page color watch statement music.');
INSERT INTO rb_survey_comments (respondent_id, comment_text) VALUES (1013, 'Off represent affect manager. career Win maintain huge in side indeed relationship right. help Cause security democratic during could since.');
INSERT INTO rb_survey_comments (respondent_id, comment_text) VALUES (1014, 'Light within town. help Arrive brother bag fine. promotion Head safe rock guess music pull.');
INSERT INTO rb_survey_comments (respondent_id, comment_text) VALUES (1015, 'Media sign really tend sport available. help Leave garden develop give then why. customer Director number as particularly pay during less.');
INSERT INTO rb_survey_comments (respondent_id, comment_text) VALUES (1016, 'Bag occur draw personal standard act weight. end user Space cost next. IJP Information return ok poor probably force night.');
INSERT INTO rb_survey_comments (respondent_id, comment_text) VALUES (1017, 'Spring western pay while tend. induction Respond prevent address suffer. aid Still bed read top daughter.');
INSERT INTO rb_survey_comments (respondent_id, comment_text) VALUES (1018, 'Education nothing let through trouble phone. lateral Return dark society Democrat radio opportunity. customer Local magazine put check look coach wall.');
INSERT INTO rb_survey_comments (respondent_id, comment_text) VALUES (1019, 'Prepare treat good reality attack. from_within Business blood represent. orientation Or under vote church care nothing land.');
INSERT INTO rb_survey_comments (respondent_id, comment_text) VALUES (1020, 'But its avoid thousand director. transfer Common certain if certainly cut. orientation Issue know reflect.');
INSERT INTO rb_survey_comments (respondent_id, comment_text) VALUES (1021, 'Natural health large interesting science each sound. user Ask send there report owner still. collaboration Factor single skill relate form of boy.');
INSERT INTO rb_survey_comments (respondent_id, comment_text) VALUES (1022, 'Relate personal summer community. support State after future however drop while feeling. onboarding How source Congress upon dream husband state.');
INSERT INTO rb_survey_comments (respondent_id, comment_text) VALUES (1023, 'Thousand hundred Congress study scene dark. internal Public table almost save nation event carry. aid American age turn training trip believe cell.');
INSERT INTO rb_survey_comments (respondent_id, comment_text) VALUES (1024, 'Theory deep wait name compare involve. onboarding Make we network. client Difficult draw option church remember ever.');
INSERT INTO rb_survey_comments (respondent_id, comment_text) VALUES (1025, 'Seat son within several probably share house. support Nearly college computer picture. IJP Station face public challenge right magazine.');
INSERT INTO rb_survey_comments (respondent_id, comment_text) VALUES (1026, 'Subject thing under floor. growth Something north dog middle. onboarding Event price be bank pressure forget.');
INSERT INTO rb_survey_comments (respondent_id, comment_text) VALUES (1027, 'Year author suffer thought claim discover home. aid Care history now note than education. user Heart land cover marriage loss continue.');
INSERT INTO rb_survey_comments (respondent_id, comment_text) VALUES (1028, 'Must story account center attorney forget not. internal Deal where same time sense meet. aid Surface research capital time stuff defense town.');
INSERT INTO rb_survey_comments (respondent_id, comment_text) VALUES (1029, 'Main line charge newspaper somebody most. IJP Whatever hit foreign else. career Bill important against strong everything accept offer.');
INSERT INTO rb_survey_comments (respondent_id, comment_text) VALUES (1030, 'Owner hot none place animal table true. growth Service although your up cost scene. transfer Avoid environment hospital president that group.');
INSERT INTO rb_survey_comments (respondent_id, comment_text) VALUES (1031, 'Make military trouble method hand lot boy character. help Feel man car site season. promotion Technology low front human store red.');
INSERT INTO rb_survey_comments (respondent_id, comment_text) VALUES (1032, 'Much degree class should soon face people. orientation Green yourself fund decide machine instead quickly science. end user Stage know bag.');
INSERT INTO rb_survey_comments (respondent_id, comment_text) VALUES (1033, 'Citizen edge page them often. support Range open production foreign. orientation Administration listen several approach.');
INSERT INTO rb_survey_comments (respondent_id, comment_text) VALUES (1034, 'House material area finally time. aid Would policy rule last ahead control. from_within Wall than improve summer clearly compare cup.');
INSERT INTO rb_survey_comments (respondent_id, comment_text) VALUES (1035, 'Energy interesting seem along team down I. orientation Big him station security former government end. career Present less realize according well.');
INSERT INTO rb_survey_comments (respondent_id, comment_text) VALUES (1036, 'Take will here world bad any room. IJP Able camera itself analysis ground husband. collaboration Close early success important old.');
INSERT INTO rb_survey_comments (respondent_id, comment_text) VALUES (1037, 'Rise material hold arrive brother owner. collaboration Allow painting at check night. help Force personal science condition party.');
INSERT INTO rb_survey_comments (respondent_id, comment_text) VALUES (1038, 'Sort within reduce consider follow finish car. transfer Perhaps director have building apply activity. promotion Popular yeah home chair reason message go.');
INSERT INTO rb_survey_comments (respondent_id, comment_text) VALUES (1039, 'Level you hand girl sport in pay. internal Half same line natural population. onboarding Actually inside night whom than.');
INSERT INTO rb_survey_comments (respondent_id, comment_text) VALUES (1040, 'Business should stage sort small rest. end user Tell stock wonder seem nice bank. support Join several news message weight think.');
INSERT INTO rb_survey_comments (respondent_id, comment_text) VALUES (1041, 'Trade as agency shake feel impact explain wall. user Development impact American forward south raise kitchen. assistance Wear Democrat no certain.');
INSERT INTO rb_survey_comments (respondent_id, comment_text) VALUES (1042, 'Player relationship beautiful. promotion Goal final century rock type. user Bill key seek idea science performance agent.');
INSERT INTO rb_survey_comments (respondent_id, comment_text) VALUES (1043, 'Resource fill high national site clearly. orientation White turn capital have change management. user Determine become majority have Democrat exist.');
INSERT INTO rb_survey_comments (respondent_id, comment_text) VALUES (1044, 'Opportunity safe huge impact risk seek ever. support Poor watch air learn bit above. customer Public four task red shoulder.');
INSERT INTO rb_survey_comments (respondent_id, comment_text) VALUES (1045, 'Development myself national tend. growth Special book first do former. collaboration Continue main ago seat.');
INSERT INTO rb_survey_comments (respondent_id, comment_text) VALUES (1046, 'Yard officer start think run full. collaboration Would must important. induction Knowledge response role share bar stuff.');
INSERT INTO rb_survey_comments (respondent_id, comment_text) VALUES (1047, 'Teacher form officer impact. client Summer fast history question worker low fall. career Goal office after experience enjoy.');
INSERT INTO rb_survey_comments (respondent_id, comment_text) VALUES (1048, 'Major reality down light safe by. group Experience international help together future operation. user Process lead book.');
INSERT INTO rb_survey_comments (respondent_id, comment_text) VALUES (1049, 'Bad successful concern wonder. promotion Into fund world. from_within Event star green final focus.');
INSERT INTO rb_survey_comments (respondent_id, comment_text) VALUES (1050, 'Everyone eight interview much professor position response. customer History west remain all ago great no edge. development Role television thus so save apply the present.');
INSERT INTO rb_survey_comments (respondent_id, comment_text) VALUES (1051, 'About beat positive those. cooperation Lay personal game whole role company participant. lateral Seven foot maybe commercial room than crime.');
INSERT INTO rb_survey_comments (respondent_id, comment_text) VALUES (1052, 'Them debate clearly simply fight hundred herself land. onboarding Theory establish teacher he cost resource easy record. collaboration Painting fear manager television child.');
INSERT INTO rb_survey_comments (respondent_id, comment_text) VALUES (1053, 'Sign laugh enjoy. orientation Size staff thought life. client Task into rich explain west crime.');
INSERT INTO rb_survey_comments (respondent_id, comment_text) VALUES (1054, 'Little allow decade rich free college. help Stay fear son break. development Realize character place sea you that modern budget.');
INSERT INTO rb_survey_comments (respondent_id, comment_text) VALUES (1055, 'It matter behind teach choose person. orientation Probably candidate develop art fire base will. collaboration Whole others away face.');
INSERT INTO rb_survey_comments (respondent_id, comment_text) VALUES (1056, 'Decade interest serve heart already. group Live interest career listen call tree. orientation Former woman none father.');
INSERT INTO rb_survey_comments (respondent_id, comment_text) VALUES (1057, 'Fear defense group sometimes green city cultural. orientation Whether least though century body much. assistance Sure effect take relate maybe reach high leave.');
INSERT INTO rb_survey_comments (respondent_id, comment_text) VALUES (1058, 'Democrat analysis thank. team Carry majority major land natural friend. from_within Number whether kid main.');
INSERT INTO rb_survey_comments (respondent_id, comment_text) VALUES (1059, 'Can even begin ability know. group Drug ability individual discussion. growth Would outside compare direction.');
INSERT INTO rb_survey_comments (respondent_id, comment_text) VALUES (1060, 'View someone lead health Mr. IJP Situation finally worry. collaboration Yard require without left level pretty take.');
INSERT INTO rb_survey_comments (respondent_id, comment_text) VALUES (1061, 'Job own team lose management. end user Down indicate within. orientation Really feeling music high good important look.');
INSERT INTO rb_survey_comments (respondent_id, comment_text) VALUES (1062, 'Government five indicate knowledge light else however apply. from_within Yourself type almost yeah machine dinner. onboarding Why agent enter specific relate major data next.');
INSERT INTO rb_survey_comments (respondent_id, comment_text) VALUES (1063, 'Change attention country certain investment medical summer. team Professor similar thousand. onboarding Seek travel sister three.');
INSERT INTO rb_survey_comments (respondent_id, comment_text) VALUES (1064, 'Continue catch head agency memory amount. lateral Foreign listen tend weight same operation culture. group Agreement family commercial concern.');
INSERT INTO rb_survey_comments (respondent_id, comment_text) VALUES (1065, 'Save air measure really. end user Major center look address admit visit student. aid Glass lead generation particular church possible continue.');
INSERT INTO rb_survey_comments (respondent_id, comment_text) VALUES (1066, 'Various certain quality nothing. promotion Series receive idea character heart attention. from_within Pass water produce sing news.');
INSERT INTO rb_survey_comments (respondent_id, comment_text) VALUES (1067, 'Just step us experience kitchen more be form. onboarding Chair western follow nation short network peace. end user Couple us class simple record.');
INSERT INTO rb_survey_comments (respondent_id, comment_text) VALUES (1068, 'Artist do TV each theory purpose market. help Three effort high total up. career Argue large draw.');
INSERT INTO rb_survey_comments (respondent_id, comment_text) VALUES (1069, 'Wonder color month machine. growth Product material instead use same choose foreign. onboarding Letter special especially difficult to.');
INSERT INTO rb_survey_comments (respondent_id, comment_text) VALUES (1070, 'Since station identify thought leg church beyond crime. development Teacher use future next challenge training. group Arrive information should street choose.');
INSERT INTO rb_survey_comments (respondent_id, comment_text) VALUES (1071, 'Within no note general. team Give firm street husband picture. user Free church market lawyer card firm woman coach.');
INSERT INTO rb_survey_comments (respondent_id, comment_text) VALUES (1072, 'Away me though item feeling me. team Assume million many beautiful pass open memory sea. help On evidence find well but simple.');
INSERT INTO rb_survey_comments (respondent_id, comment_text) VALUES (1073, 'Give guy pass first pressure. assistance Tv paper apply live interesting. career Rather dark common official rock decade pull heart.');
INSERT INTO rb_survey_comments (respondent_id, comment_text) VALUES (1074, 'Matter cup ever five involve resource. onboarding Whose relationship purpose reason size gas real. assistance Hour threat turn radio serve.');
INSERT INTO rb_survey_comments (respondent_id, comment_text) VALUES (1075, 'Statement final others any stay. career Many make similar impact practice end know past. aid Meet strategy party car forget fund trouble.');
INSERT INTO rb_survey_comments (respondent_id, comment_text) VALUES (1076, 'Light say when give. client War fear whose agent him would. development Still drop east level.');
INSERT INTO rb_survey_comments (respondent_id, comment_text) VALUES (1077, 'Month sound always Democrat argue. support Quality her wind with. end user Partner energy your piece institution strong clear maybe.');
INSERT INTO rb_survey_comments (respondent_id, comment_text) VALUES (1078, 'Best or live carry professional list. internal Moment start become you. growth College any feel meeting hard.');
INSERT INTO rb_survey_comments (respondent_id, comment_text) VALUES (1079, 'Baby wide perhaps least sit career. from_within Get along president when. help Statement money body medical.');
INSERT INTO rb_survey_comments (respondent_id, comment_text) VALUES (1080, 'So couple thing sure. client Out feeling everybody she. assistance Song good such program event pattern maybe.');
INSERT INTO rb_survey_comments (respondent_id, comment_text) VALUES (1081, 'Foreign animal authority save hand likely structure. career Continue ok owner bed social. assistance Could technology today interesting.');
INSERT INTO rb_survey_comments (respondent_id, comment_text) VALUES (1082, 'Doctor expect building different anyone half. cooperation Run point development national pay. assistance Series car position fund Mr through network low.');
INSERT INTO rb_survey_comments (respondent_id, comment_text) VALUES (1083, 'Woman few college middle write throughout. help Those again phone personal commercial. development Ok follow manage western ball.');
INSERT INTO rb_survey_comments (respondent_id, comment_text) VALUES (1084, 'Far respond over impact improve. assistance Choice operation well fast. customer Should tree chair get.');
INSERT INTO rb_survey_comments (respondent_id, comment_text) VALUES (1085, 'Water them attack group. support Impact generation effect goal official break term. team Defense east watch role attorney whose discover.');
INSERT INTO rb_survey_comments (respondent_id, comment_text) VALUES (1086, 'Mother outside house chance attention degree understand allow. group Brother property sea what color company. customer Thought turn gas common window figure dream.');
INSERT INTO rb_survey_comments (respondent_id, comment_text) VALUES (1087, 'Office plan deep officer this station imagine. assistance Town stuff important fast agent each size. customer War their check they.');
INSERT INTO rb_survey_comments (respondent_id, comment_text) VALUES (1088, 'Add hit walk. team Court single base whose age rise be red. user Situation area beyond east record piece.');
INSERT INTO rb_survey_comments (respondent_id, comment_text) VALUES (1089, 'Most more prepare wide tree religious. development Teach story least red us poor. client Body which drug effort.');
INSERT INTO rb_survey_comments (respondent_id, comment_text) VALUES (1090, 'Set total tell rather staff that claim. orientation Boy per issue road those. client Girl perform court pull first.');
INSERT INTO rb_survey_comments (respondent_id, comment_text) VALUES (1091, 'Know whatever rich consider. internal Life quality establish explain check name moment. end user Affect minute great doctor care.');
INSERT INTO rb_survey_comments (respondent_id, comment_text) VALUES (1092, 'Ago painting truth its first. group That show stuff they investment. development Air begin top will project.');
INSERT INTO rb_survey_comments (respondent_id, comment_text) VALUES (1093, 'List onto opportunity some culture various list where. induction Religious expert hundred option eye. growth Most whose better station strong then.');
INSERT INTO rb_survey_comments (respondent_id, comment_text) VALUES (1094, 'Pm involve plan owner author visit. promotion Hot store report at rise career like science. client Decision measure toward billion ago.');
INSERT INTO rb_survey_comments (respondent_id, comment_text) VALUES (1095, 'Region down building raise smile fine identify. promotion Program sing they high special item base forget. client Threat people result experience real person certain.');
INSERT INTO rb_survey_comments (respondent_id, comment_text) VALUES (1096, 'Green put or student image west. induction Authority ago authority environmental summer when water. user Black bar audience that beat.');
INSERT INTO rb_survey_comments (respondent_id, comment_text) VALUES (1097, 'Pay four method job movie third tree. internal Ten factor artist police wear citizen budget. user Effort head pretty car.');
INSERT INTO rb_survey_comments (respondent_id, comment_text) VALUES (1098, 'Rise himself south cut under agreement defense face. induction Or try best law without front rest firm. growth Since deal agency could generation rock understand.');
INSERT INTO rb_survey_comments (respondent_id, comment_text) VALUES (1099, 'Arrive they goal be until. onboarding Drop fall notice charge even investment. cooperation Should very system wall page agency behavior customer.');

-- Word Groups
INSERT INTO rb_word_groups (group_name, words) VALUES ('#bacghr_client', '"client" OR "customer" OR "user" OR "end user"');
INSERT INTO rb_word_groups (group_name, words) VALUES ('#bacghr_internalmove', '"internal" OR "transfer" OR "from_within" OR "lateral" OR "IJP"');
INSERT INTO rb_word_groups (group_name, words) VALUES ('#bacghr_career', '"career" OR "promotion" OR "growth" OR "development"');
INSERT INTO rb_word_groups (group_name, words) VALUES ('#bacghr_onboarding', '"onboarding" OR "orientation" OR "induction"');
INSERT INTO rb_word_groups (group_name, words) VALUES ('#bacghr_team', '"team" OR "collaboration" OR "cooperation" OR "group"');
INSERT INTO rb_word_groups (group_name, words) VALUES ('#bacghr_support', '"support" OR "assistance" OR "help" OR "aid"');

-- Comment Rules
INSERT INTO rb_comment_rules (topic, rule_expr_raw, exclude_expr_raw) VALUES ('Client Satisfaction', '#bacghr_client NEAR #bacghr_support WITHIN 5', NULL);
INSERT INTO rb_comment_rules (topic, rule_expr_raw, exclude_expr_raw) VALUES ('Internal Mobility', '#bacghr_internalmove NEAR opportunity WITHIN 4', 'attorney OR contractor');
INSERT INTO rb_comment_rules (topic, rule_expr_raw, exclude_expr_raw) VALUES ('Career Growth', '#bacghr_career NEAR lacking WITHIN 6', NULL);
INSERT INTO rb_comment_rules (topic, rule_expr_raw, exclude_expr_raw) VALUES ('Onboarding', '#bacghr_onboarding NEAR helpful WITHIN 3', NULL);
INSERT INTO rb_comment_rules (topic, rule_expr_raw, exclude_expr_raw) VALUES ('Team Culture', '#bacghr_team NEAR issues WITHIN 2', '#bacghr_client');


-- Sample Queries

-- Find all comments matching rules
SELECT c.id, c.comment_text, r.topic
FROM rb_survey_comments c
JOIN rb_comment_rules r
  ON CONTAINS(c.comment_text, expand_macros(r.rule_expr_raw), 1) > 0
WHERE r.exclude_expr_raw IS NULL 
   OR CONTAINS(c.comment_text, expand_macros(r.exclude_expr_raw), 2) = 0;

-- Highlighted matched snippet
SELECT c.id,
       CTX_DOC.SNIPPET('comment_text_idx', c.id, expand_macros(r.rule_expr_raw)) AS snippet
FROM rb_survey_comments c
JOIN rb_comment_rules r
  ON CONTAINS(c.comment_text, expand_macros(r.rule_expr_raw), 1) > 0;

-- Summary count by topic
SELECT r.topic, COUNT(*) AS match_count
FROM rb_survey_comments c
JOIN rb_comment_rules r
  ON CONTAINS(c.comment_text, expand_macros(r.rule_expr_raw), 1) > 0
WHERE r.exclude_expr_raw IS NULL 
   OR CONTAINS(c.comment_text, expand_macros(r.exclude_expr_raw), 2) = 0
GROUP BY r.topic;
